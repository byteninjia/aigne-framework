# AIGNE CLI å®Œæ•´ä½¿ç”¨æµç¨‹æŒ‡å—

[English](./complete-cli-workflow.md) | [ä¸­æ–‡](./complete-cli-workflow.zh.md)

æœ¬æŒ‡å—å°†å¸¦æ‚¨å®Œæ•´ä½“éªŒ AIGNE CLI çš„æ•´ä¸ªå·¥ä½œæµç¨‹ï¼Œä»åˆ›å»ºé¡¹ç›®å¼€å§‹ï¼Œåˆ°é…ç½® Agentï¼Œå†åˆ°è¿è¡Œå’Œéƒ¨ç½²æœåŠ¡ã€‚é€šè¿‡è¿™ä¸ªç«¯åˆ°ç«¯çš„æµç¨‹ï¼Œæ‚¨å°†æŒæ¡ä½¿ç”¨ AIGNE CLI å¼€å‘å’Œéƒ¨ç½² AI Agent çš„å®Œæ•´æŠ€èƒ½ã€‚

## æ¦‚è¿°

AIGNE CLI æä¾›äº†ä¸€å¥—å®Œæ•´çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè®©æ‚¨èƒ½å¤Ÿï¼š

* ğŸš€ **å¿«é€Ÿåˆ›å»ºé¡¹ç›®** - ä½¿ç”¨ `aigne create` åˆ›å»ºæ–°çš„ AIGNE é¡¹ç›®
* âš™ï¸ **é…ç½® Agent** - é€šè¿‡ YAML æ–‡ä»¶å®šä¹‰ Agent çš„è¡Œä¸ºå’Œèƒ½åŠ›
* â–¶ï¸ **è¿è¡Œå’Œæµ‹è¯•** - ä½¿ç”¨ `aigne run` è¿è¡Œ Agent å¹¶è¿›è¡Œäº¤äº’æµ‹è¯•
* ğŸŒ **éƒ¨ç½²æœåŠ¡** - ä½¿ç”¨ `aigne serve-mcp` å°† Agent éƒ¨ç½²ä¸º MCP æœåŠ¡å™¨
* ğŸ“Š **ç›‘æ§è§‚å¯Ÿ** - ä½¿ç”¨ `aigne observe` ç›‘æ§ Agent çš„è¿è¡ŒçŠ¶æ€

## å‰ç½®å‡†å¤‡

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å·²ç»ï¼š

1. **å®‰è£… Node.js** - ç‰ˆæœ¬ v20 æˆ–æ›´é«˜
2. **å®‰è£… AIGNE CLI** - å…¨å±€å®‰è£… CLI å·¥å…·
3. **å‡†å¤‡ API å¯†é’¥** - è·å–æ‚¨é€‰æ‹©çš„ AI æ¨¡å‹æä¾›å•†çš„ API å¯†é’¥

### å®‰è£… AIGNE CLI

```bash
npm install -g @aigne/cli
```

éªŒè¯å®‰è£…ï¼š

```bash
aigne --version
```

## åˆ›å»ºæ–°é¡¹ç›®

ä½¿ç”¨ `aigne create` å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„ AIGNE é¡¹ç›®ï¼š

```bash
# äº¤äº’å¼åˆ›å»ºé¡¹ç›®
aigne create

# æˆ–è€…æŒ‡å®šé¡¹ç›®åç§°
aigne create my-ai-assistant
```

å‘½ä»¤æ‰§è¡Œåï¼ŒCLI ä¼šæç¤ºæ‚¨è¾“å…¥é¡¹ç›®åç§°ï¼Œç„¶åè‡ªåŠ¨åˆ›å»ºé¡¹ç›®ç›®å½•å’ŒåŸºç¡€é…ç½®æ–‡ä»¶ã€‚

### é¡¹ç›®ç»“æ„

åˆ›å»ºçš„é¡¹ç›®åŒ…å«ä»¥ä¸‹åŸºæœ¬ç»“æ„ï¼š

```
my-ai-assistant/
â”œâ”€â”€ aigne.yaml          # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ chat.yaml           # ç¤ºä¾‹ Agent é…ç½®
â”œâ”€â”€ .env.local.example  # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md           # é¡¹ç›®è¯´æ˜
```

## é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶å¹¶é…ç½®æ‚¨çš„ API å¯†é’¥ï¼š

```bash
cd my-ai-assistant
cp .env.local.example .env.local
```

ç¼–è¾‘ `.env.local` æ–‡ä»¶ï¼Œæ·»åŠ æ‚¨çš„ API å¯†é’¥ï¼š

```bash
# OpenAI API å¯†é’¥
OPENAI_API_KEY=your_openai_api_key_here

# æˆ–è€…å…¶ä»–æ¨¡å‹æä¾›å•†çš„å¯†é’¥
# ANTHROPIC_API_KEY=your_anthropic_api_key_here
# GOOGLE_API_KEY=your_google_api_key_here
```

## é…ç½®ä¸»é¡¹ç›®æ–‡ä»¶

ç¼–è¾‘ `aigne.yaml` æ–‡ä»¶ï¼Œé…ç½®é¡¹ç›®çš„å…¨å±€è®¾ç½®ï¼š

```yaml
# é…ç½®é»˜è®¤çš„èŠå¤©æ¨¡å‹
chat_model:
  provider: openai         # æ¨¡å‹æä¾›å•†
  name: gpt-4o-mini        # æ¨¡å‹åç§°
  temperature: 0.7         # æ§åˆ¶è¾“å‡ºçš„éšæœºæ€§

# æŒ‡å®šé¡¹ç›®ä¸­çš„ Agent é…ç½®æ–‡ä»¶
agents:
  - chat.yaml              # åŸºç¡€èŠå¤© Agent
  - poem.yaml              # è¯—æ­Œåˆ›ä½œ Agentï¼ˆå¯é€‰ï¼‰
```

## åˆ›å»ºå’Œé…ç½® Agent

### åŸºç¡€ Agent é…ç½®

ç¼–è¾‘ `chat.yaml` æ–‡ä»¶ï¼Œå®šä¹‰æ‚¨çš„ Agentï¼š

```yaml
name: chat
description: æ™ºèƒ½èŠå¤©åŠ©æ‰‹
instructions: |
  ä½ æ˜¯ä¸€ä¸ªå‹å–„ã€ä¸“ä¸šçš„ AI åŠ©æ‰‹ã€‚ä½ èƒ½å¤Ÿï¼š
  - å›ç­”å„ç§é—®é¢˜
  - æä¾›æœ‰ç”¨çš„å»ºè®®
  - ååŠ©è§£å†³é—®é¢˜
  - è¿›è¡Œè‡ªç„¶çš„å¯¹è¯

  è¯·å§‹ç»ˆä¿æŒç¤¼è²Œã€å‡†ç¡®å’Œæœ‰å¸®åŠ©çš„æ€åº¦ã€‚
input_key: message
memory: true              # å¯ç”¨å¯¹è¯è®°å¿†
```

### é«˜çº§ Agent é…ç½®

åˆ›å»ºä¸€ä¸ªæ›´å¤æ‚çš„ Agentï¼Œä¾‹å¦‚ `poem.yaml`ï¼š

```yaml
name: poem
description: è¯—æ­Œåˆ›ä½œåŠ©æ‰‹
instructions: |
  ä½ æ˜¯ä¸€ä¸ªè¯—æ­Œåˆ›ä½œä¸“å®¶ã€‚ä½ èƒ½å¤Ÿï¼š
  - åˆ›ä½œå„ç§é£æ ¼çš„è¯—æ­Œ
  - åˆ†æå’Œè¯„è®ºè¯—æ­Œ
  - æä¾›è¯—æ­Œåˆ›ä½œæŠ€å·§

  è¯·ä½¿ç”¨å¯Œæœ‰è¡¨ç°åŠ›çš„è¯­è¨€ï¼Œä¿æŒè¯—æ„å’Œè‰ºæœ¯æ€§ã€‚
  è¯·ä»¥ {{topic}} ä¸ºä¸»é¢˜åˆ›ä½œä¸€é¦– {{style}} é£æ ¼çš„è¯—æ­Œã€‚

# å®šä¹‰è¾“å…¥æ•°æ®ç»“æ„
input_schema:
  type: object
  properties:
    topic:
      type: string
      description: è¯—æ­Œä¸»é¢˜
    style:
      type: string
      description: è¯—æ­Œé£æ ¼ï¼ˆå¦‚ç°ä»£ã€å¤å…¸ç­‰ï¼‰
  required:
    - topic
    - style

memory: true
```

## è¿è¡Œ Agent

### åŸºæœ¬è¿è¡Œ

ä½¿ç”¨ `aigne run` å‘½ä»¤è¿è¡Œæ‚¨çš„ Agentï¼š

```bash
# è¿è¡Œé»˜è®¤ Agent
aigne run

# è¿è¡Œç‰¹å®š Agent
aigne run --entry-agent poem

# å¯ç”¨èŠå¤©æ¨¡å¼è¿›è¡Œäº¤äº’
aigne run --chat
```

### å•æ¬¡æŸ¥è¯¢æ¨¡å¼

```bash
# ç›´æ¥æä¾›è¾“å…¥è¿›è¡Œå•æ¬¡æŸ¥è¯¢
aigne run --input "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±"

# ä½¿ç”¨ç‰¹å®šæ¨¡å‹
aigne run --model openai:gpt-4.1 --input "è§£é‡Šä¸€ä¸‹æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µ"

# ä½¿ç”¨ç‰¹å®š Agent å’Œè¾“å…¥
aigne run --entry-agent poem --input-topic "æ˜¥å¤©" --input-style "ç°ä»£"
```

### è°ƒæ•´æ¨¡å‹å‚æ•°

```bash
# è®¾ç½®è¾ƒä½æ¸©åº¦è·å¾—æ›´ç¡®å®šçš„è¾“å‡º
aigne run --temperature 0.2 --entry-agent poem --input-topic "ç§‹å¤©" --input-style "å¤å…¸"
```

### å¯ç”¨è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
aigne run --log-level debug --chat
```

## å¯åŠ¨ç›‘æ§æœåŠ¡

åœ¨å¼€å‘å’Œæµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæ‚¨å¯ä»¥å¯åŠ¨ç›‘æ§æœåŠ¡æ¥è§‚å¯Ÿ Agent çš„è¿è¡ŒçŠ¶æ€ï¼š

```bash
# å¯åŠ¨ç›‘æ§æœåŠ¡ï¼ˆé»˜è®¤ç«¯å£ 7890ï¼‰
aigne observe

# ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£
aigne observe --port 8080

# å…¬å¼€è®¿é—®
aigne observe --host 0.0.0.0
```

ç›‘æ§æœåŠ¡å¯åŠ¨åï¼Œæ‚¨å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://localhost:7890` æŸ¥çœ‹ Agent çš„è¿è¡Œæ•°æ®å’Œæ€§èƒ½æŒ‡æ ‡ã€‚

## éƒ¨ç½²ä¸º MCP æœåŠ¡å™¨

å½“æ‚¨çš„ Agent å¼€å‘å®Œæˆå¹¶æµ‹è¯•é€šè¿‡åï¼Œå¯ä»¥å°†å…¶éƒ¨ç½²ä¸º MCP æœåŠ¡å™¨ï¼š

```bash
# å¯åŠ¨ MCP æœåŠ¡å™¨ï¼ˆé»˜è®¤ç«¯å£ 3000ï¼‰
aigne serve-mcp

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
aigne serve-mcp --host 0.0.0.0 --port 8080 --pathname /api/agents
```

æ¥ä¸‹æ¥ä½ å¯ä»¥åœ¨æ”¯æŒ MCP çš„å®¢æˆ·ç«¯ä¸­è¿æ¥è¯¥æœåŠ¡å™¨ï¼Œè¿›è¡Œäº¤äº’å’Œè°ƒç”¨ï¼ˆæ³¨æ„ aigne serve-mcp ä»…æ”¯æŒ streamable http åè®®ï¼‰ã€‚

## æ€»ç»“

é€šè¿‡æœ¬æŒ‡å—ï¼Œæ‚¨å·²ç»æŒæ¡äº† AIGNE CLI çš„å®Œæ•´ä½¿ç”¨æµç¨‹ã€‚ä»é¡¹ç›®åˆ›å»ºåˆ°ç”Ÿäº§éƒ¨ç½²ï¼ŒAIGNE CLI æä¾›äº†ä¸€å¥—å®Œæ•´çš„å·¥å…·é“¾ï¼Œè®©æ‚¨èƒ½å¤Ÿé«˜æ•ˆåœ°å¼€å‘å’Œéƒ¨ç½² AI Agentã€‚

è®°ä½ï¼ŒæˆåŠŸçš„ AI Agent å¼€å‘éœ€è¦ï¼š

* æ¸…æ™°çš„éœ€æ±‚å®šä¹‰
* åˆç†çš„æ¶æ„è®¾è®¡
* æŒç»­çš„ç›‘æ§ä¼˜åŒ–

ç°åœ¨æ‚¨å¯ä»¥å¼€å§‹æ„å»ºè‡ªå·±çš„ AI Agent é¡¹ç›®äº†ï¼ğŸš€
